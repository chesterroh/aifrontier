---
import { getCollection, render } from 'astro:content';
import EpisodeLayout from '../../../layouts/EpisodeLayout.astro';
import ResourceLink from '../../../components/ResourceLink.astro';

export async function getStaticPaths() {
  const episodes = await getCollection('episodes', ({ data }) => data.lang === 'en');
  return episodes.map((episode) => ({
    params: { slug: `ep${episode.data.episodeNumber}` },
    props: { episode },
  }));
}

const { episode } = Astro.props;
const { Content } = await render(episode);
const { data } = episode;
---

<EpisodeLayout
  episodeNumber={data.episodeNumber}
  title={data.title}
  description={data.description}
  publishedAt={data.publishedAt}
  duration={data.duration}
  youtubeId={data.youtubeId}
  thumbnail={data.thumbnail}
  hosts={data.hosts}
  chapters={data.chapters}
  lang="en"
  alternateSlug={data.alternateSlug}
  notionUrl={data.notionUrl}
>
  <Content components={{ ResourceLink }} />
</EpisodeLayout>
